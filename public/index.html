<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Immersify Portal</title>
    <script type="text/javascript" src="https://download.playfab.com/PlayFabClientApi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
<!-- Dark Mode Toggle Switch -->
<div class="dark-mode-toggle">â˜€
    <label class="switch">.
        <input type="checkbox" id="darkModeSwitch">
        <span class="slider round"></span>
    </label>
</div>
<!-- Login Modal -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <img src="/immersify_logo.e141b23db21f4b78051561bc464eace7.svg" alt="Immersify Logo" class="login-logo">
        <h2>Login</h2>
        <input type="text" id="username" placeholder="Username"><br>
        <input type="password" id="password" placeholder="Password"><br>
        <input type="button" id="loginButton" value="Login">
    </div>
</div>
<div id="report-container" class="container">
    <input id="segment-toggle-btn" type="button" class="collapsible-button" value="Segments">
    <div id="segments-section" class="collapsible-content">
        <h2>Segments</h2>
        <select name="segmentSelection" id="segmentSelection"></select>
        <input type="button" id="getSegmentsButton" value="Get Segments">
        <input type="button" id="getSegmentPlayersButton" value="Get Users in Segment">
        <p id="totalPlayersSegment">Total users in segment:</p>
    </div>

    <h2>Report</h2>
    <p id="dbLastUpdated">Database last updated: </p>
    <p id="totalPlayersReport">Total users in report:</p>
    <input class="small-toggle-button" type="button" id="toggleIdsButton" value="show / hide IDs">
    <textarea id="playerIDList" readonly></textarea>
    <textarea id="emailList" placeholder="Enter email addresses here, suffixes, or topics one per line"></textarea> 
    <div class="button-container">
        <input type="button" id="generateReportButton" value="Generate Report By Email List">
        <input type="button" id="generateReportByIdButton" value="Generate Report By Ids">
        <input type="button" id="generateReportBySuffixButton" value="Generate Report By Email Suffix">
        <input type="button" id="generateReportByTopicButton" value="Generate Report By Topic">
        <input type="button" id="generateReportByAreaButton" value="Generate Report By Academic Area">
        <input type="button" id="insightsButton" value="Insights">
        <input type="button" id="exportReportButton" value="Export to Excel">
    </div>
    <br /><br />
    <table id="reportTable">
        <thead>
            <tr>
                <th>Email Address</th>
                <th>Account Created</th>
                <th>Last Login</th>
                <th>Days Since Last Login</th>
                <th>Days Since Creation</th>
                <th>Expiry Date</th>
                <th>Days to Expiry</th>
                <th>Created By</th>
                <th>Reason</th>
                <th>Linked Accounts</th>
                <th>Usage Data</th>
            </tr>
        </thead>
        <tbody id="reportTableBody"><!-- Rows will be added here by the generateReport() function --></tbody>
    </table>
</div>
<div id="playerDataModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closePlayerDataModal">&times;</span>
        <div id="playerDataModalBody"></div>
    </div>
</div>
<div id="insightsModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeInsightsButton">&times;</span>
        <h2>Insights</h2>        
        <div id="insightsContent"><!-- Insights will be displayed here --></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.1/dist/confetti.browser.js"></script>
<script type="module" src="scripts/main.js"></script>
<script type="module" src="scripts/insights.js"></script>
<script type="module" src="scripts/PlayFabManager.js"></script>
<script type="module" src="scripts/confluence.js"></script>
<script type="module" src="scripts/utils.js"></script>
<script type="module" src="scripts/asyncTools.js"></script>

</body>
</html>